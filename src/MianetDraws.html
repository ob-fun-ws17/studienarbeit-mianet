<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings, DeriveGeneric #-}</span><span>
</span><a name="line-2"></a><span class="hs-comment">{- |
Module      : MianetDraws
Description : This module implements the logic of the game
Copyright   : 2018 Philipp Mayer &amp; Engelbrecht Nils
License     : BSD3
Maintainer  : Philipp Mayer
-}</span><span>
</span><a name="line-9"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">MianetDraws</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-10"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><a href="Helper.html"><span class="hs-identifier">Helper</span></a><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><a href="MianetGetter.html"><span class="hs-identifier">MianetGetter</span></a><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><a href="Types.html"><span class="hs-identifier">Types</span></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><a href="Dice.html"><span class="hs-identifier">Dice</span></a><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><a href="MianetDistributor.html"><span class="hs-identifier">MianetDistributor</span></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><a href="Distributor.html"><span class="hs-identifier">Distributor</span></a><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">unpack</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">pack</span><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span class="hs-operator">.</span><span class="hs-identifier">Split</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Generics</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Applicative</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Exception</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">finally</span><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">forM_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">forever</span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Concurrent</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MVar</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">newMVar</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">modifyMVar_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">modifyMVar</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">readMVar</span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Network</span><span class="hs-operator">.</span><span class="hs-identifier">WebSockets</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">WS</span><span>
</span><a name="line-28"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-comment">-- | moves the first client in the connection list to the last position.</span><span>
</span><a name="line-31"></a><span class="hs-identifier">moveClient</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Types.html#ServerState"><span class="hs-identifier hs-type">ServerState</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#ServerState"><span class="hs-identifier hs-type">ServerState</span></a><span>
</span><a name="line-32"></a><a name="moveClient"><a href="MianetDraws.html#moveClient"><span class="hs-identifier">moveClient</span></a></a><span> </span><a name="local-6989586621679064482"><a href="#local-6989586621679064482"><span class="hs-identifier">clients</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679064482"><span class="hs-identifier hs-var">clients</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679064482"><span class="hs-identifier hs-var">clients</span></a><span class="hs-special">]</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-comment">-- | the reactor accused the actor of lying. it returns the result.</span><span>
</span><a name="line-35"></a><span class="hs-identifier">accuse</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MVar</span><span> </span><a href="Types.html#ServerState"><span class="hs-identifier hs-type">ServerState</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">MVar</span><span> </span><a href="Types.html#Draw"><span class="hs-identifier hs-type">Draw</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><a name="accuse"><a href="MianetDraws.html#accuse"><span class="hs-identifier">accuse</span></a></a><span> </span><a name="local-6989586621679064483"><a href="#local-6989586621679064483"><span class="hs-identifier">stateMVar</span></a></a><span> </span><a name="local-6989586621679064484"><a href="#local-6989586621679064484"><span class="hs-identifier">lastDrawMVar</span></a></a><span> </span><a name="local-6989586621679064485"><a href="#local-6989586621679064485"><span class="hs-identifier">maxScore</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-37"></a><span>            </span><a name="local-6989586621679064486"><a href="#local-6989586621679064486"><span class="hs-identifier">lastDraw</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readMVar</span><span> </span><a href="#local-6989586621679064484"><span class="hs-identifier hs-var">lastDrawMVar</span></a><span>
</span><a name="line-38"></a><span>            </span><span class="hs-keyword">if</span><span> </span><a href="Helper.html#fst%27"><span class="hs-identifier hs-var">fst'</span></a><span> </span><a href="#local-6989586621679064486"><span class="hs-identifier hs-var">lastDraw</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="Helper.html#thd%27"><span class="hs-identifier hs-var">thd'</span></a><span> </span><a href="#local-6989586621679064486"><span class="hs-identifier hs-var">lastDraw</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Helper.html#fst%27"><span class="hs-identifier hs-var">fst'</span></a><span> </span><a href="#local-6989586621679064486"><span class="hs-identifier hs-var">lastDraw</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Helper.html#snd%27"><span class="hs-identifier hs-var">snd'</span></a><span> </span><a href="#local-6989586621679064486"><span class="hs-identifier hs-var">lastDraw</span></a><span>
</span><a name="line-39"></a><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-40"></a><span>                    </span><a name="local-6989586621679064487"><a href="#local-6989586621679064487"><span class="hs-identifier">actorName</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MianetGetter.html#getActorName"><span class="hs-identifier hs-var">getActorName</span></a><span> </span><a href="#local-6989586621679064483"><span class="hs-identifier hs-var">stateMVar</span></a><span>
</span><a name="line-41"></a><span>                    </span><a name="local-6989586621679064488"><a href="#local-6989586621679064488"><span class="hs-identifier">defaultMessage</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MianetGetter.html#getDefaultMessage"><span class="hs-identifier hs-var">getDefaultMessage</span></a><span> </span><a href="#local-6989586621679064484"><span class="hs-identifier hs-var">lastDrawMVar</span></a><span>
</span><a name="line-42"></a><span>                    </span><a href="MianetDistributor.html#sendToActor"><span class="hs-identifier hs-var">sendToActor</span></a><span> </span><a href="#local-6989586621679064483"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679064488"><span class="hs-identifier hs-var">defaultMessage</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mappend</span><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;. Runde beendet. Du gewinnst&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span>                    </span><a href="MianetDistributor.html#sendToReactor"><span class="hs-identifier hs-var">sendToReactor</span></a><span> </span><a href="#local-6989586621679064483"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679064488"><span class="hs-identifier hs-var">defaultMessage</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mappend</span><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;. Runde beendet. Du verlierst&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span>                    </span><a href="MianetDistributor.html#sendToAllExceptActorAndReactor"><span class="hs-identifier hs-var">sendToAllExceptActorAndReactor</span></a><span> </span><a href="#local-6989586621679064483"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679064488"><span class="hs-identifier hs-var">defaultMessage</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mappend</span><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;. Runde beendet. &quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mappend</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679064487"><span class="hs-identifier hs-var">actorName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mappend</span><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;gewinnt&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span>                    </span><a href="MianetDraws.html#incrementScore"><span class="hs-identifier hs-var">incrementScore</span></a><span> </span><a href="#local-6989586621679064483"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><a href="MianetGetter.html#getActorName"><span class="hs-identifier hs-var">getActorName</span></a><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-48"></a><span>                    </span><a name="local-6989586621679064489"><a href="#local-6989586621679064489"><span class="hs-identifier">reactorName</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MianetGetter.html#getReactorName"><span class="hs-identifier hs-var">getReactorName</span></a><span> </span><a href="#local-6989586621679064483"><span class="hs-identifier hs-var">stateMVar</span></a><span>
</span><a name="line-49"></a><span>                    </span><a name="local-6989586621679064490"><a href="#local-6989586621679064490"><span class="hs-identifier">defaultMessage</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MianetGetter.html#getDefaultMessage"><span class="hs-identifier hs-var">getDefaultMessage</span></a><span> </span><a href="#local-6989586621679064484"><span class="hs-identifier hs-var">lastDrawMVar</span></a><span>
</span><a name="line-50"></a><span>                    </span><a href="MianetDistributor.html#sendToActor"><span class="hs-identifier hs-var">sendToActor</span></a><span> </span><a href="#local-6989586621679064483"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679064490"><span class="hs-identifier hs-var">defaultMessage</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mappend</span><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;. Runde beendet. Du verlierst&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span>                    </span><a href="MianetDistributor.html#sendToReactor"><span class="hs-identifier hs-var">sendToReactor</span></a><span> </span><a href="#local-6989586621679064483"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679064490"><span class="hs-identifier hs-var">defaultMessage</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mappend</span><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;. Runde beendet. Du gewinnst&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span>                    </span><a href="MianetDistributor.html#sendToAllExceptActorAndReactor"><span class="hs-identifier hs-var">sendToAllExceptActorAndReactor</span></a><span> </span><a href="#local-6989586621679064483"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679064490"><span class="hs-identifier hs-var">defaultMessage</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mappend</span><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;. Runde beendet. &quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mappend</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679064489"><span class="hs-identifier hs-var">reactorName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mappend</span><span class="hs-special">`</span><span> </span><span class="hs-string">&quot; gewinnt&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span>                    </span><a href="MianetDraws.html#incrementScore"><span class="hs-identifier hs-var">incrementScore</span></a><span> </span><a href="#local-6989586621679064483"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><a href="MianetGetter.html#getReactorName"><span class="hs-identifier hs-var">getReactorName</span></a><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span>            </span><a href="MianetDraws.html#nextDraw"><span class="hs-identifier hs-var">nextDraw</span></a><span> </span><a href="#local-6989586621679064483"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><a href="#local-6989586621679064484"><span class="hs-identifier hs-var">lastDrawMVar</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679064485"><span class="hs-identifier hs-var">maxScore</span></a><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-comment">-- | increments the score of the actor or reactor.</span><span>
</span><a name="line-58"></a><span class="hs-identifier">incrementScore</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MVar</span><span> </span><a href="Types.html#ServerState"><span class="hs-identifier hs-type">ServerState</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MVar</span><span> </span><a href="Types.html#ServerState"><span class="hs-identifier hs-type">ServerState</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-59"></a><a name="incrementScore"><a href="MianetDraws.html#incrementScore"><span class="hs-identifier">incrementScore</span></a></a><span> </span><a name="local-6989586621679064491"><a href="#local-6989586621679064491"><span class="hs-identifier">stateMVar</span></a></a><span> </span><a name="local-6989586621679064492"><a href="#local-6989586621679064492"><span class="hs-identifier">func</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-60"></a><span>    </span><a name="local-6989586621679064493"><a href="#local-6989586621679064493"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679064492"><span class="hs-identifier hs-var">func</span></a><span> </span><a href="#local-6989586621679064491"><span class="hs-identifier hs-var">stateMVar</span></a><span>
</span><a name="line-61"></a><span>    </span><span class="hs-identifier hs-var">modifyMVar_</span><span> </span><a href="#local-6989586621679064491"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679064516"><a href="#local-6989586621679064516"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-62"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679064517"><a href="#local-6989586621679064517"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MianetDraws.html#incrementWinCountForClient"><span class="hs-identifier hs-var">incrementWinCountForClient</span></a><span> </span><a href="#local-6989586621679064493"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679064516"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-63"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679064517"><span class="hs-identifier hs-var">s'</span></a><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-comment">-- | increments the score of a specific client.</span><span>
</span><a name="line-66"></a><span class="hs-identifier">incrementWinCountForClient</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#ServerState"><span class="hs-identifier hs-type">ServerState</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Types.html#ServerState"><span class="hs-identifier hs-type">ServerState</span></a><span>
</span><a name="line-67"></a><a name="incrementWinCountForClient"><a href="MianetDraws.html#incrementWinCountForClient"><span class="hs-identifier">incrementWinCountForClient</span></a></a><span> </span><a name="local-6989586621679064518"><a href="#local-6989586621679064518"><span class="hs-identifier">clientName</span></a></a><span> </span><a name="local-6989586621679064519"><a href="#local-6989586621679064519"><span class="hs-identifier">clients</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-68"></a><span>    </span><span class="hs-comment">--filter (\(a,_, _) -&gt; a /= clientName) clients</span><span>
</span><a name="line-69"></a><span>    </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679064520"><a href="#local-6989586621679064520"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679064521"><a href="#local-6989586621679064521"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679064522"><a href="#local-6989586621679064522"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679064520"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679064518"><span class="hs-identifier hs-var">clientName</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679064520"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679064521"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679064522"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679064520"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679064521"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679064522"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679064519"><span class="hs-identifier hs-var">clients</span></a><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-comment">-- | initiates the next draw and sends the respective messages to the clients.</span><span>
</span><a name="line-72"></a><span class="hs-identifier">nextDraw</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MVar</span><span> </span><a href="Types.html#ServerState"><span class="hs-identifier hs-type">ServerState</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">MVar</span><span> </span><a href="Types.html#Draw"><span class="hs-identifier hs-type">Draw</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-73"></a><a name="nextDraw"><a href="MianetDraws.html#nextDraw"><span class="hs-identifier">nextDraw</span></a></a><span> </span><a name="local-6989586621679064523"><a href="#local-6989586621679064523"><span class="hs-identifier">stateMVar</span></a></a><span> </span><a name="local-6989586621679064524"><a href="#local-6989586621679064524"><span class="hs-identifier">lastDrawMVar</span></a></a><span> </span><a name="local-6989586621679064525"><a href="#local-6989586621679064525"><span class="hs-identifier">lastRoundWin</span></a></a><span> </span><a name="local-6989586621679064526"><a href="#local-6989586621679064526"><span class="hs-identifier">maxScore</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679064525"><span class="hs-identifier hs-var">lastRoundWin</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">2100</span><span>
</span><a name="line-76"></a><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-77"></a><span>            </span><a name="local-6989586621679064533"><a href="#local-6989586621679064533"><span class="hs-identifier">defaultMessage</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MianetGetter.html#getDefaultMessage"><span class="hs-identifier hs-var">getDefaultMessage</span></a><span> </span><a href="#local-6989586621679064524"><span class="hs-identifier hs-var">lastDrawMVar</span></a><span>
</span><a name="line-78"></a><span>            </span><a href="MianetDistributor.html#sendToActor"><span class="hs-identifier hs-var">sendToActor</span></a><span> </span><a href="#local-6989586621679064523"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;W&#252;rfelergebnis: 21!. Runde beendet. Du gewinnst&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-79"></a><span>            </span><a href="MianetDistributor.html#sendToAllExceptActor"><span class="hs-identifier hs-var">sendToAllExceptActor</span></a><span> </span><a href="#local-6989586621679064523"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;W&#252;rfelergebnis: 21!. Runde beendet. Du verlierst&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span>            </span><a href="MianetDraws.html#incrementScore"><span class="hs-identifier hs-var">incrementScore</span></a><span> </span><a href="#local-6989586621679064523"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><a href="MianetGetter.html#getActorName"><span class="hs-identifier hs-var">getActorName</span></a><span>
</span><a name="line-81"></a><span>            </span><a name="local-6989586621679064534"><a href="#local-6989586621679064534"><span class="hs-identifier">endOfGame</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MianetDraws.html#checkForWin"><span class="hs-identifier hs-var">checkForWin</span></a><span> </span><a href="#local-6989586621679064523"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><a href="#local-6989586621679064526"><span class="hs-identifier hs-var">maxScore</span></a><span>
</span><a name="line-82"></a><span>            </span><a href="#local-6989586621679064527"><span class="hs-identifier hs-var">doNextDraw</span></a><span> </span><a href="#local-6989586621679064534"><span class="hs-identifier hs-var">endOfGame</span></a><span> </span><a href="#local-6989586621679064523"><span class="hs-identifier hs-var">stateMVar</span></a><span>
</span><a name="line-83"></a><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-84"></a><span>            </span><a name="local-6989586621679064535"><a href="#local-6989586621679064535"><span class="hs-identifier">endOfGame</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MianetDraws.html#checkForWin"><span class="hs-identifier hs-var">checkForWin</span></a><span> </span><a href="#local-6989586621679064523"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><a href="#local-6989586621679064526"><span class="hs-identifier hs-var">maxScore</span></a><span>
</span><a name="line-85"></a><span>            </span><a href="#local-6989586621679064527"><span class="hs-identifier hs-var">doNextDraw</span></a><span> </span><a href="#local-6989586621679064535"><span class="hs-identifier hs-var">endOfGame</span></a><span> </span><a href="#local-6989586621679064523"><span class="hs-identifier hs-var">stateMVar</span></a><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-88"></a><span>        </span><a name="local-6989586621679064527"><a href="#local-6989586621679064527"><span class="hs-identifier">doNextDraw</span></a></a><span> </span><a name="local-6989586621679064528"><a href="#local-6989586621679064528"><span class="hs-identifier">endOfGame</span></a></a><span> </span><a name="local-6989586621679064529"><a href="#local-6989586621679064529"><span class="hs-identifier">stateMVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-89"></a><span>            </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621679064528"><span class="hs-identifier hs-var">endOfGame</span></a><span>
</span><a name="line-90"></a><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-91"></a><span>                    </span><span class="hs-identifier hs-var">modifyMVar_</span><span> </span><a href="#local-6989586621679064524"><span class="hs-identifier hs-var">lastDrawMVar</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679064530"><a href="#local-6989586621679064530"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-92"></a><span>                        </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679064525"><span class="hs-identifier hs-var">lastRoundWin</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">2100</span><span>
</span><a name="line-93"></a><span>                            </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-94"></a><span>                                </span><span class="hs-comment">--defaultMessage &lt;- getDefaultMessage lastDrawMVar</span><span>
</span><a name="line-95"></a><span>                                </span><span class="hs-comment">--incrementScore stateMVar getActorName</span><span>
</span><a name="line-96"></a><span>                                </span><span class="hs-comment">--sendToActor stateMVar (defaultMessage `mappend` &quot;. Runde beendet. Du gewinnst&quot;)</span><span>
</span><a name="line-97"></a><span>                                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>                            </span><span class="hs-keyword">else</span><span>
</span><a name="line-99"></a><span>                                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679064525"><span class="hs-identifier hs-var">lastRoundWin</span></a><span class="hs-special">)</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span>                    </span><a name="local-6989586621679064531"><a href="#local-6989586621679064531"><span class="hs-identifier">stateMVar'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MianetDraws.html#moveToNextDraw"><span class="hs-identifier hs-var">moveToNextDraw</span></a><span> </span><a href="#local-6989586621679064529"><span class="hs-identifier hs-var">stateMVar</span></a><span>
</span><a name="line-102"></a><span>                    </span><a name="local-6989586621679064532"><a href="#local-6989586621679064532"><span class="hs-identifier">order</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MianetGetter.html#getOrder"><span class="hs-identifier hs-var">getOrder</span></a><span> </span><a href="#local-6989586621679064529"><span class="hs-identifier hs-var">stateMVar</span></a><span>
</span><a name="line-103"></a><span>                    </span><a href="MianetDistributor.html#sendToActor"><span class="hs-identifier hs-var">sendToActor</span></a><span> </span><a href="#local-6989586621679064531"><span class="hs-identifier hs-var">stateMVar'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;Du bist am Zug. Du musst W&#252;rfeln (rolldices). &quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mappend</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679064532"><span class="hs-identifier hs-var">order</span></a><span>
</span><a name="line-104"></a><span>                    </span><a href="MianetDistributor.html#sendToAllExceptActor"><span class="hs-identifier hs-var">sendToAllExceptActor</span></a><span> </span><a href="#local-6989586621679064531"><span class="hs-identifier hs-var">stateMVar'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679064532"><span class="hs-identifier hs-var">order</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mappend</span><span class="hs-special">`</span><span> </span><span class="hs-string">&quot; warten...&quot;</span><span>
</span><a name="line-105"></a><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-106"></a><span>                    </span><a href="MianetDraws.html#endOfGameFunc"><span class="hs-identifier hs-var">endOfGameFunc</span></a><span> </span><a href="#local-6989586621679064529"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><a href="#local-6989586621679064526"><span class="hs-identifier hs-var">maxScore</span></a><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span class="hs-comment">-- | initiates the next draw. it calls the moveClient function.</span><span>
</span><a name="line-109"></a><span class="hs-identifier">moveToNextDraw</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MVar</span><span> </span><a href="Types.html#ServerState"><span class="hs-identifier hs-type">ServerState</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MVar</span><span> </span><a href="Types.html#ServerState"><span class="hs-identifier hs-type">ServerState</span></a><span class="hs-special">)</span><span>
</span><a name="line-110"></a><a name="moveToNextDraw"><a href="MianetDraws.html#moveToNextDraw"><span class="hs-identifier">moveToNextDraw</span></a></a><span> </span><a name="local-6989586621679064536"><a href="#local-6989586621679064536"><span class="hs-identifier">stateMVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-111"></a><span>    </span><span class="hs-identifier hs-var">modifyMVar_</span><span> </span><a href="#local-6989586621679064536"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679064537"><a href="#local-6989586621679064537"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-112"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679064538"><a href="#local-6989586621679064538"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MianetDraws.html#moveClient"><span class="hs-identifier hs-var">moveClient</span></a><span> </span><a href="#local-6989586621679064537"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-113"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679064538"><span class="hs-identifier hs-var">s'</span></a><span>
</span><a name="line-114"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679064536"><span class="hs-identifier hs-var">stateMVar</span></a><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-comment">-- | rolls dices two times and returns the result.</span><span>
</span><a name="line-117"></a><span class="hs-identifier">rollDices'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MVar</span><span> </span><a href="Types.html#Draw"><span class="hs-identifier hs-type">Draw</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-118"></a><a name="rollDices%27"><a href="MianetDraws.html#rollDices%27"><span class="hs-identifier">rollDices'</span></a></a><span> </span><a name="local-6989586621679064539"><a href="#local-6989586621679064539"><span class="hs-identifier">lastDrawMVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-119"></a><span>    </span><a name="local-6989586621679064540"><a href="#local-6989586621679064540"><span class="hs-identifier">roll1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Dice.html#rollDice"><span class="hs-identifier hs-var">rollDice</span></a><span>
</span><a name="line-120"></a><span>    </span><a name="local-6989586621679064541"><a href="#local-6989586621679064541"><span class="hs-identifier">roll2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Dice.html#rollDice"><span class="hs-identifier hs-var">rollDice</span></a><span>
</span><a name="line-121"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679064542"><a href="#local-6989586621679064542"><span class="hs-identifier">nums</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Dice.html#formatNums"><span class="hs-identifier hs-var">formatNums</span></a><span> </span><a href="#local-6989586621679064540"><span class="hs-identifier hs-var">roll1</span></a><span> </span><a href="#local-6989586621679064541"><span class="hs-identifier hs-var">roll2</span></a><span>
</span><a name="line-122"></a><span>    </span><a name="local-6989586621679064545"><a href="#local-6989586621679064545"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">modifyMVar_</span><span> </span><a href="#local-6989586621679064539"><span class="hs-identifier hs-var">lastDrawMVar</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679064543"><a href="#local-6989586621679064543"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-123"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679064544"><a href="#local-6989586621679064544"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679064542"><span class="hs-identifier hs-var">nums</span></a><span> </span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><a href="Helper.html#thd%27"><span class="hs-identifier hs-var">thd'</span></a><span> </span><a href="#local-6989586621679064543"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679064544"><span class="hs-identifier hs-var">s'</span></a><span>
</span><a name="line-125"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679064542"><span class="hs-identifier hs-var">nums</span></a><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-comment">-- | checks if somebody got the max score.</span><span>
</span><a name="line-128"></a><span class="hs-identifier">checkForWin</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MVar</span><span> </span><a href="Types.html#ServerState"><span class="hs-identifier hs-type">ServerState</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-129"></a><a name="checkForWin"><a href="MianetDraws.html#checkForWin"><span class="hs-identifier">checkForWin</span></a></a><span> </span><a name="local-6989586621679064546"><a href="#local-6989586621679064546"><span class="hs-identifier">stateMVar</span></a></a><span> </span><a name="local-6989586621679064547"><a href="#local-6989586621679064547"><span class="hs-identifier">maxScore</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-130"></a><span>    </span><a name="local-6989586621679064548"><a href="#local-6989586621679064548"><span class="hs-identifier">state</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readMVar</span><span> </span><a href="#local-6989586621679064546"><span class="hs-identifier hs-var">stateMVar</span></a><span>
</span><a name="line-131"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679064549"><a href="#local-6989586621679064549"><span class="hs-identifier">win</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679064549"><span class="hs-identifier hs-var">win</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679064547"><span class="hs-identifier hs-var">maxScore</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679064548"><span class="hs-identifier hs-var">state</span></a><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-comment">-- | inititates the end of a game.</span><span>
</span><a name="line-134"></a><span class="hs-identifier">endOfGameFunc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MVar</span><span> </span><a href="Types.html#ServerState"><span class="hs-identifier hs-type">ServerState</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-135"></a><a name="endOfGameFunc"><a href="MianetDraws.html#endOfGameFunc"><span class="hs-identifier">endOfGameFunc</span></a></a><span> </span><a name="local-6989586621679064550"><a href="#local-6989586621679064550"><span class="hs-identifier">stateMVar</span></a></a><span> </span><a name="local-6989586621679064551"><a href="#local-6989586621679064551"><span class="hs-identifier">maxScore</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-136"></a><span>    </span><a name="local-6989586621679064552"><a href="#local-6989586621679064552"><span class="hs-identifier">state</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readMVar</span><span> </span><a href="#local-6989586621679064550"><span class="hs-identifier hs-var">stateMVar</span></a><span>
</span><a name="line-137"></a><span>    </span><a name="local-6989586621679064553"><a href="#local-6989586621679064553"><span class="hs-identifier">winnerName</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MianetGetter.html#getwinnerName"><span class="hs-identifier hs-var">getwinnerName</span></a><span> </span><a href="#local-6989586621679064550"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><a href="#local-6989586621679064551"><span class="hs-identifier hs-var">maxScore</span></a><span>
</span><a name="line-138"></a><span>    </span><a href="MianetDistributor.html#sendToWinner"><span class="hs-identifier hs-var">sendToWinner</span></a><span> </span><a href="#local-6989586621679064550"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><a href="#local-6989586621679064551"><span class="hs-identifier hs-var">maxScore</span></a><span> </span><span class="hs-string">&quot;Spiel beendet. Du gewinnst!&quot;</span><span>
</span><a name="line-139"></a><span>    </span><a href="MianetDistributor.html#sendToLooser"><span class="hs-identifier hs-var">sendToLooser</span></a><span> </span><a href="#local-6989586621679064550"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><a href="#local-6989586621679064551"><span class="hs-identifier hs-var">maxScore</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Spiel beendet. &quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mappend</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679064553"><span class="hs-identifier hs-var">winnerName</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mappend</span><span class="hs-special">`</span><span> </span><span class="hs-string">&quot; hat gewonnen&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-140"></a><span>    </span><span class="hs-comment">-- sendToActor stateMVar &quot;Spiel beendet. Du gewinnst!&quot;</span><span>
</span><a name="line-141"></a><span>    </span><span class="hs-comment">-- broadcastExceptOf msg [actor] state  stateMVar (&quot;Spiel beendet. &quot; `mappend` actorN `mappend` &quot; hat gewonnen&quot;)</span><span>
</span><a name="line-142"></a><span>    </span><a href="MianetDistributor.html#sendToAllClients"><span class="hs-identifier hs-var">sendToAllClients</span></a><span> </span><a href="#local-6989586621679064550"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;nochmal: (rematch). Spiel verlassen: (closeGame)&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-comment">-- | it logs the entered dice result of the actor.</span><span>
</span><a name="line-145"></a><span class="hs-identifier">logResult</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MVar</span><span> </span><a href="Types.html#ServerState"><span class="hs-identifier hs-type">ServerState</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">MVar</span><span> </span><a href="Types.html#Draw"><span class="hs-identifier hs-type">Draw</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-146"></a><a name="logResult"><a href="MianetDraws.html#logResult"><span class="hs-identifier">logResult</span></a></a><span> </span><a name="local-6989586621679064554"><a href="#local-6989586621679064554"><span class="hs-identifier">stateMVar</span></a></a><span> </span><a name="local-6989586621679064555"><a href="#local-6989586621679064555"><span class="hs-identifier">lastDrawMVar</span></a></a><span> </span><a name="local-6989586621679064556"><a href="#local-6989586621679064556"><span class="hs-identifier">parameter</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-147"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="MianetDraws.html#validResult"><span class="hs-identifier hs-var">validResult</span></a><span> </span><a href="#local-6989586621679064556"><span class="hs-identifier hs-var">parameter</span></a><span>
</span><a name="line-148"></a><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-149"></a><span>            </span><a name="local-6989586621679064558"><a href="#local-6989586621679064558"><span class="hs-identifier">lastDraw</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readMVar</span><span> </span><a href="#local-6989586621679064555"><span class="hs-identifier hs-var">lastDrawMVar</span></a><span>
</span><a name="line-150"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679064559"><a href="#local-6989586621679064559"><span class="hs-identifier">loggedResult'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Dice.html#formatNums"><span class="hs-identifier hs-var">formatNums</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679064557"><span class="hs-identifier hs-var">loggedResult</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">!!</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679064557"><span class="hs-identifier hs-var">loggedResult</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>            </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679064559"><span class="hs-identifier hs-var">loggedResult'</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="Helper.html#thd%27"><span class="hs-identifier hs-var">thd'</span></a><span> </span><a href="#local-6989586621679064558"><span class="hs-identifier hs-var">lastDraw</span></a><span>
</span><a name="line-152"></a><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-153"></a><span>                    </span><a name="local-6989586621679064560"><a href="#local-6989586621679064560"><span class="hs-identifier">lastDraw</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readMVar</span><span> </span><a href="#local-6989586621679064555"><span class="hs-identifier hs-var">lastDrawMVar</span></a><span>
</span><a name="line-154"></a><span>                    </span><a href="MianetDistributor.html#sendToActor"><span class="hs-identifier hs-var">sendToActor</span></a><span> </span><a href="#local-6989586621679064554"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Error: Eingeloggtes Ergebnis muss &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-155"></a><span>                        </span><span class="hs-string">&quot;gr&#246;&#223;er sein als das Ergebnis der letzten Runde (&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-156"></a><span>                        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Dice.html#deformatNums"><span class="hs-identifier hs-var">deformatNums</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Helper.html#thd%27"><span class="hs-identifier hs-var">thd'</span></a><span> </span><a href="#local-6989586621679064560"><span class="hs-identifier hs-var">lastDraw</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;).&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-158"></a><span>                    </span><a name="local-6989586621679064561"><a href="#local-6989586621679064561"><span class="hs-identifier">lastDraw</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readMVar</span><span> </span><a href="#local-6989586621679064555"><span class="hs-identifier hs-var">lastDrawMVar</span></a><span>
</span><a name="line-159"></a><span>                    </span><a name="local-6989586621679064562"><a href="#local-6989586621679064562"><span class="hs-identifier">reactorN</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MianetGetter.html#getReactorName"><span class="hs-identifier hs-var">getReactorName</span></a><span> </span><a href="#local-6989586621679064554"><span class="hs-identifier hs-var">stateMVar</span></a><span>
</span><a name="line-160"></a><span>                    </span><a name="local-6989586621679064563"><a href="#local-6989586621679064563"><span class="hs-identifier">actorN</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MianetGetter.html#getActorName"><span class="hs-identifier hs-var">getActorName</span></a><span> </span><a href="#local-6989586621679064554"><span class="hs-identifier hs-var">stateMVar</span></a><span>
</span><a name="line-161"></a><span>                    </span><a name="local-6989586621679064564"><a href="#local-6989586621679064564"><span class="hs-identifier">order</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MianetGetter.html#getOrder"><span class="hs-identifier hs-var">getOrder</span></a><span> </span><a href="#local-6989586621679064554"><span class="hs-identifier hs-var">stateMVar</span></a><span>
</span><a name="line-162"></a><span>                    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679064565"><a href="#local-6989586621679064565"><span class="hs-identifier">resultMessage</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unpack</span><span> </span><a href="#local-6989586621679064563"><span class="hs-identifier hs-var">actorN</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-163"></a><span>                            </span><span class="hs-string">&quot; hat gew&#252;rfelt. W&#252;rfelergebnis: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-164"></a><span>                            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Dice.html#deformatNums"><span class="hs-identifier hs-var">deformatNums</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679064559"><span class="hs-identifier hs-var">loggedResult'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-165"></a><span>                            </span><span class="hs-string">&quot;. Ergebnis der letzten Runde: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-166"></a><span>                            </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Dice.html#deformatNums"><span class="hs-identifier hs-var">deformatNums</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Helper.html#thd%27"><span class="hs-identifier hs-var">thd'</span></a><span> </span><a href="#local-6989586621679064561"><span class="hs-identifier hs-var">lastDraw</span></a><span class="hs-special">)</span><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span>                    </span><a href="MianetDistributor.html#sendToReactor"><span class="hs-identifier hs-var">sendToReactor</span></a><span> </span><a href="#local-6989586621679064554"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679064565"><span class="hs-identifier hs-var">resultMessage</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;. L&#252;ge? (ja: accuse / nein: nextdraw)&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-169"></a><span>
</span><a name="line-170"></a><span>                    </span><a href="MianetDistributor.html#sendToActor"><span class="hs-identifier hs-var">sendToActor</span></a><span> </span><a href="#local-6989586621679064554"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;warten auf &quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mappend</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679064562"><span class="hs-identifier hs-var">reactorN</span></a><span>
</span><a name="line-171"></a><span>                    </span><a href="MianetDistributor.html#sendToAllExceptActorAndReactor"><span class="hs-identifier hs-var">sendToAllExceptActorAndReactor</span></a><span> </span><a href="#local-6989586621679064554"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679064565"><span class="hs-identifier hs-var">resultMessage</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;. &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unpack</span><span> </span><a href="#local-6989586621679064564"><span class="hs-identifier hs-var">order</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;. warten...&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span>                    </span><span class="hs-identifier hs-var">modifyMVar_</span><span> </span><a href="#local-6989586621679064555"><span class="hs-identifier hs-var">lastDrawMVar</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679064566"><a href="#local-6989586621679064566"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-174"></a><span>                        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679064567"><a href="#local-6989586621679064567"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Helper.html#fst%27"><span class="hs-identifier hs-var">fst'</span></a><span> </span><a href="#local-6989586621679064566"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679064559"><span class="hs-identifier hs-var">loggedResult'</span></a><span class="hs-special">,</span><span> </span><a href="Helper.html#thd%27"><span class="hs-identifier hs-var">thd'</span></a><span> </span><a href="#local-6989586621679064566"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-175"></a><span>                        </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679064567"><span class="hs-identifier hs-var">s'</span></a><span>
</span><a name="line-176"></a><span>        </span><span class="hs-keyword">else</span><span> </span><a href="MianetDistributor.html#sendToActor"><span class="hs-identifier hs-var">sendToActor</span></a><span> </span><a href="#local-6989586621679064554"><span class="hs-identifier hs-var">stateMVar</span></a><span> </span><span class="hs-string">&quot;unvalid result&quot;</span><span>
</span><a name="line-177"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-178"></a><span>        </span><a name="local-6989586621679064557"><a href="#local-6989586621679064557"><span class="hs-identifier">loggedResult</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><a href="MianetDraws.html#addToListWithConv"><span class="hs-identifier hs-var">addToListWithConv</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679064556"><span class="hs-identifier hs-var">parameter</span></a><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-comment">-- | checks if it's a valid result.</span><span>
</span><a name="line-182"></a><span class="hs-identifier">validResult</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-183"></a><a name="validResult"><a href="MianetDraws.html#validResult"><span class="hs-identifier">validResult</span></a></a><span> </span><a name="local-6989586621679064568"><a href="#local-6989586621679064568"><span class="hs-identifier">parameter</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679064568"><span class="hs-identifier hs-var">parameter</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679064569"><a href="#local-6989586621679064569"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679064570"><a href="#local-6989586621679064570"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679064570"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679064569"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="Dice.html#dice"><span class="hs-identifier hs-var">dice</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679064568"><span class="hs-identifier hs-var">parameter</span></a><span class="hs-special">)</span><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span class="hs-comment">-- | converts a char to a list of integer and puts it to another list of integer.</span><span>
</span><a name="line-186"></a><span class="hs-identifier">addToListWithConv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>
</span><a name="line-187"></a><a name="addToListWithConv"><a href="MianetDraws.html#addToListWithConv"><span class="hs-identifier">addToListWithConv</span></a></a><span> </span><a name="local-6989586621679064571"><a href="#local-6989586621679064571"><span class="hs-identifier">myList</span></a></a><span> </span><a name="local-6989586621679064572"><a href="#local-6989586621679064572"><span class="hs-identifier">myChar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">read</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679064572"><span class="hs-identifier hs-var">myChar</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679064571"><span class="hs-identifier hs-var">myList</span></a><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-comment">-- | in process.</span><span>
</span><a name="line-190"></a><span class="hs-identifier">addToListWithConv'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>
</span><a name="line-191"></a><a name="addToListWithConv%27"><a href="MianetDraws.html#addToListWithConv%27"><span class="hs-identifier">addToListWithConv'</span></a></a><span> </span><a name="local-6989586621679064573"><a href="#local-6989586621679064573"><span class="hs-identifier">myList</span></a></a><span> </span><a name="local-6989586621679064574"><a href="#local-6989586621679064574"><span class="hs-identifier">myChar</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-192"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679064574"><span class="hs-identifier hs-var">myChar</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-193"></a><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679064578"><a href="#local-6989586621679064578"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679064574"><span class="hs-identifier hs-var">myChar</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679064578"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679064576"><span class="hs-identifier hs-var">numsAsString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679064575"><span class="hs-identifier hs-var">readList</span></a><span>
</span><a name="line-194"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-197"></a><span>        </span><a name="local-6989586621679064575"><a href="#local-6989586621679064575"><span class="hs-identifier">readList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">read</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679064574"><span class="hs-identifier hs-var">myChar</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679064573"><span class="hs-identifier hs-var">myList</span></a><span>
</span><a name="line-198"></a><span>        </span><a name="local-6989586621679064576"><a href="#local-6989586621679064576"><span class="hs-identifier">numsAsString</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679064577"><a href="#local-6989586621679064577"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679064577"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-number">9</span><span class="hs-special">]</span><span>
</span><a name="line-199"></a></pre></body></html>